================================================================================
                        é¦–é¡µæ•°æ®åŠ è½½æµç¨‹ - å®Œæ•´åˆ†ææ€»ç»“
================================================================================

ã€é¡¹ç›®æ¦‚è§ˆã€‘
  - å‰ç«¯: React + TypeScript (apps/web)
  - åç«¯: NestJS + Prisma ORM (apps/api)
  - æ•°æ®åº“: PostgreSQL
  - ç¼“å­˜: Redis + å†…å­˜é™çº§
  - æ–°é—»æº: å¤šä¸ªRSSæº + AIåˆ†æ(GLM)

================================================================================
ã€æ•°æ®æµå‘ã€‘
================================================================================

1. å‰ç«¯è¯·æ±‚
   â”œâ”€ App.tsx åˆå§‹åŒ– useEffect
   â”œâ”€ è°ƒç”¨ fetchNewsFromAPI({page, limit, category, search})
   â””â”€ è§£æå“åº”ï¼Œæ›´æ–°ReactçŠ¶æ€

2. åç«¯å¤„ç†
   â”œâ”€ news.controller.ts getNews() å¤„ç†è¯·æ±‚
   â”œâ”€ æ„å»ºSQLæŸ¥è¯¢æ¡ä»¶ WHERE
   â”œâ”€ Prisma å¹¶è¡ŒæŸ¥è¯¢æ•°æ®+æ€»æ•°
   â””â”€ è¿”å› {items[], pagination}

3. æ•°æ®åº“æŸ¥è¯¢
   â”œâ”€ SELECT * FROM news WHERE ... LIMIT 20 OFFSET 0
   â””â”€ SELECT COUNT(*) FROM news WHERE ...

4. å‰ç«¯æ¸²æŸ“
   â”œâ”€ æ˜ å°„æ•°æ®åˆ°Reactç»„ä»¶
   â”œâ”€ æ¸²æŸ“NewsCardåˆ—è¡¨
   â””â”€ åˆå§‹åŒ–æ— é™æ»šåŠ¨ç›‘å¬

================================================================================
ã€æ ¸å¿ƒä»£ç ä½ç½®ã€‘
================================================================================

å‰ç«¯:
  âˆš ä¸»é¡µé¢: apps/web/src/App.tsx (610è¡Œ)
  âˆš APIæœåŠ¡: apps/web/src/services/newsService.ts (224è¡Œ)
  âˆš ç»Ÿè®¡å¡ç‰‡: apps/web/src/components/DashboardStats.tsx
  âˆš æ–°é—»å¡ç‰‡: apps/web/src/components/NewsCard.tsx

åç«¯:
  âˆš æ§åˆ¶å™¨: apps/api/src/modules/news/controllers/news.controller.ts (343è¡Œ)
    - getNews(): è·å–åˆ—è¡¨ (ç¬¬34è¡Œ)
    - getNewsById(): è·å–è¯¦æƒ…ï¼Œæœ‰ç¼“å­˜ (ç¬¬160è¡Œ)
    - getTrendingNews(): è·å–è¶‹åŠ¿æ–°é—» (ç¬¬211è¡Œ)
    - getCategoryStats(): åˆ†ç±»ç»Ÿè®¡ (ç¬¬255è¡Œ)
  
  âˆš ç¼“å­˜ç­–ç•¥: apps/api/src/common/redis/cache-strategy.service.ts (272è¡Œ)
    - åŒå±‚ç¼“å­˜: Redis + å†…å­˜
    - åŠ¨æ€TTL: æ ¹æ®çƒ­åº¦è°ƒæ•´
    - è‡ªåŠ¨é™çº§: Redisä¸å¯ç”¨æ—¶ç”¨å†…å­˜
  
  âˆš RedisæœåŠ¡: apps/api/src/common/redis/redis.service.ts (480è¡Œ)
  âˆš AIåˆ†æ: apps/api/src/modules/news/services/ai-analyzer.service.ts
  âˆš æ–°é—»çˆ¬å–: apps/api/src/modules/news/services/news-scraper.service.ts
  âˆš æ•°æ®åº“: apps/api/prisma/schema.prisma

================================================================================
ã€æ€§èƒ½ç“¶é¢ˆã€‘(æœ€ä¸¥é‡åˆ°æœ€è½»)
================================================================================

1. ğŸ”´ ã€ä¸¥é‡ã€‘åˆ—è¡¨æŸ¥è¯¢æ— ç¼“å­˜
   ç°è±¡: æ¯æ¬¡ç¿»é¡µ/æœç´¢éƒ½æŸ¥è¯¢æ•°æ®åº“ (~200ms)
   æ ¹å› : news.controller.ts getNews() æ²¡æœ‰ç¼“å­˜é€»è¾‘
   å½±å“: æ•°æ®åº“è´Ÿè½½é«˜ï¼Œç”¨æˆ·ä½“éªŒå·®
   ç¼ºå¤±: Redisç¼“å­˜æ£€æŸ¥å’Œå†™å…¥
   ä¼˜åŒ–: æ·»åŠ  news:list:{page}:{limit}:{category} ç¼“å­˜

2. ğŸ”´ ã€ä¸¥é‡ã€‘æœç´¢ä½¿ç”¨ILIKEå…¨è¡¨æ‰«æ
   ç°è±¡: æœç´¢å“åº” 600-2000ms
   æ ¹å› : where.OR = [{ title: { contains: search } }] ä½æ•ˆ
   å½±å“: CPUå ç”¨é«˜ï¼Œæœç´¢ä½“éªŒå·®
   ç¼ºå¤±: å…¨æ–‡æœç´¢ç´¢å¼• (tsvector)
   ä¼˜åŒ–: CREATE INDEX idx_title_fts ON news USING GIN(to_tsvector(...))

3. ğŸŸ¡ ã€ä¸­ç­‰ã€‘ç¼ºå°‘å¤åˆç´¢å¼•
   ç°è±¡: å¤šæ¡ä»¶æŸ¥è¯¢æ—¶ EXPLAIN æ˜¾ç¤º Seq Scan
   æ ¹å› : åªæœ‰å•åˆ—ç´¢å¼•ï¼Œæ²¡æœ‰å¤åˆç´¢å¼•
   å½±å“: 30-50% æ€§èƒ½æŸå¤±
   ç¼ºå¤±: (category, publishedAt), (region, publishedAt) ç­‰
   ä¼˜åŒ–: CREATE INDEX idx_news_cat_pub ON news(category, published_at DESC)

4. ğŸŸ¡ ã€è½»å¾®ã€‘AIåˆ†æå¹¶å‘é™åˆ¶
   ç°è±¡: æ–°é—»çˆ¬å–é€Ÿåº¦å—é™
   æ ¹å› : const limit = pLimit(4) å¹¶å‘æ•°å›ºå®šä¸º4
   å½±å“: çˆ¬å–50æ¡æ–°é—»éœ€è¦ 12.5ç§’ä»¥ä¸Š
   ä¼˜åŒ–: æ ¹æ®APIé…é¢åŠ¨æ€è°ƒæ•´å¹¶å‘æ•°

================================================================================
ã€å½“å‰æ€§èƒ½æŒ‡æ ‡ã€‘
================================================================================

æ— ç¼“å­˜çŠ¶æ€:
  â”œâ”€ é¦–é¡µåŠ è½½ (20æ¡æ–°é—»): ~200ms
  â”œâ”€ ç¿»é¡µåŠ è½½ (OFFSETå¢åŠ ): ~200-300ms
  â”œâ”€ æœç´¢æŸ¥è¯¢: ~600-2000ms (ä¸¥é‡ä¾èµ–æœç´¢è¯)
  â”œâ”€ æ–°é—»è¯¦æƒ… (åˆæ¬¡): ~150ms
  â””â”€ æ–°é—»è¯¦æƒ… (ç¼“å­˜å‘½ä¸­): ~100ms âœ…

æœŸæœ›ä¼˜åŒ–å:
  â”œâ”€ é¦–é¡µåŠ è½½ (ç¼“å­˜): ~55ms (â¬‡ 72%)
  â”œâ”€ ç¿»é¡µåŠ è½½ (ç¼“å­˜): ~55ms (â¬‡ 72%)
  â”œâ”€ æœç´¢æŸ¥è¯¢ (FTSç´¢å¼•): ~100ms (â¬‡ 85%)
  â”œâ”€ æ–°é—»è¯¦æƒ… (åˆæ¬¡): ~100ms (â¬‡ 30%)
  â””â”€ æ–°é—»è¯¦æƒ… (ç¼“å­˜å‘½ä¸­): ~5ms (â¬‡ 95%)

æ€»ä½“æ”¹å–„: 3-15å€

================================================================================
ã€ç¼“å­˜ç°çŠ¶ã€‘
================================================================================

âœ… å·²æœ‰ç¼“å­˜:
  â””â”€ news:detail:{id} (æ–°é—»è¯¦æƒ…ï¼ŒåŠ¨æ€TTL 30åˆ†é’Ÿ-2å°æ—¶)

âŒ ç¼ºå¤±ç¼“å­˜:
  â”œâ”€ news:list:* (åˆ—è¡¨é¡µé¢ - æœ€ä¸¥é‡)
  â”œâ”€ news:trending:* (è¶‹åŠ¿æ–°é—»)
  â””â”€ news:stats:categories (åˆ†ç±»ç»Ÿè®¡)

ç¼“å­˜é…ç½®:
  - defaultTTL: 1800ç§’ (30åˆ†é’Ÿ)
  - hotTTL: 3600ç§’ (1å°æ—¶ï¼Œçƒ­å†…å®¹)
  - å†…å­˜ç¼“å­˜å¤§å°: æ— é™åˆ¶
  - é™çº§ç­–ç•¥: è‡ªåŠ¨å¯ç”¨

åŠ¨æ€TTLè®¡ç®—å…¬å¼:
  hotScore = viewCount*1 + impactScore*10 + bookmarkCount*5
  if hotScore >= 200 â†’ TTL=7200 (2å°æ—¶)
  else if hotScore >= 100 â†’ TTL=3600 (1å°æ—¶)
  else if hotScore >= 50 â†’ TTL=2700 (45åˆ†é’Ÿ)
  else â†’ TTL=1800 (30åˆ†é’Ÿ)

================================================================================
ã€æ•°æ®åº“ç´¢å¼•åˆ†æã€‘
================================================================================

ç°æœ‰ç´¢å¼• (âœ…å®Œæ•´):
  â”œâ”€ news_category_idx: category
  â”œâ”€ news_region_idx: region
  â”œâ”€ news_publishedat_idx: published_at DESC
  â”œâ”€ news_impactscore_idx: impact_score DESC
  â””â”€ news_istrending_idx: is_trending

ç¼ºå¤±çš„å…³é”®ç´¢å¼• (âŒ):
  â”œâ”€ (category, published_at DESC) å¤åˆç´¢å¼•
  â”œâ”€ (region, published_at DESC) å¤åˆç´¢å¼•
  â”œâ”€ (is_approved, is_trending, published_at) å¤åˆç´¢å¼•
  â”œâ”€ title tsvector å…¨æ–‡æœç´¢ç´¢å¼•
  â””â”€ summary tsvector å…¨æ–‡æœç´¢ç´¢å¼•

å»ºè®®SQL:
  CREATE INDEX idx_news_approved_trending_pub 
  ON news(is_approved, is_trending DESC, published_at DESC)
  WHERE deleted_at IS NULL;

  CREATE INDEX idx_news_title_fts 
  ON news USING GIN(to_tsvector('english', title));

  CREATE INDEX idx_news_summary_fts 
  ON news USING GIN(to_tsvector('english', summary));

================================================================================
ã€ä¼˜åŒ–å®æ–½è®¡åˆ’ã€‘
================================================================================

ã€ç¬¬1é˜¶æ®µã€‘ç«‹å³å®æ–½ (1-2å¤©) - å…³é”®ä¼˜åŒ–
  1. ä¿®æ”¹ news.controller.ts getNews()
     - æ·»åŠ ç¼“å­˜æ£€æŸ¥é€»è¾‘
     - ç¼“å­˜é”®: news:list:{page}:{limit}:{category}:{region}:{search}
     - TTL: 300ç§’ (5åˆ†é’Ÿ)
     - é¢„æœŸæ”¶ç›Š: 70% é¦–é¡µæ€§èƒ½æ”¹å–„

  2. æ·»åŠ å…¨æ–‡æœç´¢ç´¢å¼•åˆ°æ•°æ®åº“
     - åˆ›å»º idx_news_title_fts (GINå€’æ’ç´¢å¼•)
     - åˆ›å»º idx_news_summary_fts
     - ä¿®æ”¹æŸ¥è¯¢é€»è¾‘ä½¿ç”¨tsvector
     - é¢„æœŸæ”¶ç›Š: 85% æœç´¢æ€§èƒ½æ”¹å–„

ã€ç¬¬2é˜¶æ®µã€‘æ·±åº¦ä¼˜åŒ– (1å‘¨)
  1. æ·»åŠ å¤åˆç´¢å¼•
  2. ä¿®æ”¹æœç´¢æŸ¥è¯¢ä¸ºå…¨æ–‡æœç´¢
  3. ä½¿ç”¨ EXPLAIN ANALYZE éªŒè¯æŸ¥è¯¢è®¡åˆ’
  4. å®æ–½æŸ¥è¯¢æ—¥å¿—åˆ†æ

ã€ç¬¬3é˜¶æ®µã€‘æŒç»­ç›‘æ§ (æŒç»­)
  1. ç›‘æ§ç¼“å­˜å‘½ä¸­ç‡
  2. åˆ†ææ…¢æŸ¥è¯¢
  3. å®šæœŸç´¢å¼•ç»´æŠ¤
  4. ç¼“å­˜ç­–ç•¥è°ƒæ•´

================================================================================
ã€ç›‘æ§ç«¯ç‚¹ã€‘(å·²å®ç°)
================================================================================

GET /api/v1/cache/stats          # Redisç¼“å­˜ç»Ÿè®¡
GET /api/v1/cache/report         # è¯¦ç»†ç¼“å­˜æŠ¥å‘Š  
GET /api/v1/cache/keys           # ç¼“å­˜é”®åˆ—è¡¨
GET /api/v1/cache/keyspace       # é”®ç©ºé—´ç»Ÿè®¡
GET /api/v1/cache/health         # Redisè¿æ¥çŠ¶æ€

========================END OF ANALYSIS==================================
